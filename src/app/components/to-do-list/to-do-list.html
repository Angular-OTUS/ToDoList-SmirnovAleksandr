<main class="todo__main">
  <div class="todo__content">
    <h1 class="todo__title">Список задач</h1>
    @if (isLoading) {
      <app-loader></app-loader>
    } @else {
      <div class="todo__filter">
        <mat-form-field appearance="fill" [style]="'width:100%'">
          <mat-label>Выберите фильтр</mat-label>
          <mat-select [(value)]="selectedFilter" (selectionChange)="filterTasks()">
            <mat-option value="All">All</mat-option>
            <mat-option value="InProgress">InProgress</mat-option>
            <mat-option value="Completed">Completed</mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <ul class="todo__list">
        @for (task of filteredTasks; track task.id) {
          <app-to-do-list-item
            [id]="task.id"
            [text]="task.text"
            [status]="task.status"
            [selectedItemId]="selectedItemId"
            [isEdited]="this.editedItemId === task.id"
            (deleteTaskEvent)="deleteTask($event)"
            (changeTaskStatusEvent)="changeTaskStatus($event, task.id)"
            (saveTextTaskEvent)="saveTextTask($event, task.id)"
            (click)="onListItemClick(task.id)"
            (dblclick)="onListItemDblClick(task.id)"
          ></app-to-do-list-item>
        } @empty {
          <p class="todo__empty-list">
            @if (selectedFilter === 'All') {
              Задач пока нет. Создайте первую задачу в форме ниже.
            } @else {
              Задач по данному фильтру нет.
            }
          </p>
        }
      </ul>
    }
    <section class="todo__new-task">
      <app-to-do-list-create (addTaskEvent)="addTask($event)"></app-to-do-list-create>
    </section>
  </div>
  @if (selectedItemId) {
    <div class="todo__side-content">
      <div class="todo__description-view">
        <h3 class="todo__subtitle">Описание задачи</h3>
        <div class="todo__description">{{ getTaskDescription() }}</div>
      </div>
    </div>
  }
</main>
